# Project Initialization Workflow

This workflow sets up a new BMAD project with OpenProject and Archon integrations.

## Overview

Run this workflow when starting a new project to:

1. Configure OpenProject integration
2. Configure Archon integration
3. Generate CLAUDE.md from template
4. Validate all connections

## Prerequisites

- OpenProject MCP server accessible
- Archon MCP server accessible
- Project repository initialized

## Workflow Steps

### Step 1: Gather Project Information

**Ask user:**

```
Welcome to BMAD Project Initialization!

Please provide the following information:

1. Project Name (kebab-case): ___________
2. Project Display Name: ___________
3. Your Name/Alias: ___________
4. GitHub Repository URL (optional): ___________
```

### Step 2: Configure OpenProject

**Execute:**

```python
# List available OpenProject projects
projects = mcp_openproject_list_projects(active_only=True)
```

**Ask user:**

```
Available OpenProject Projects:
{list projects}

Options:
[1] Select existing project (enter number)
[2] Create new project

Your choice: ___
```

**If creating new:**

```python
project = mcp_openproject_create_project(
    name="{display_name}",
    identifier="{project_name}",
    description="{description}",
    public=True
)
openproject_project_id = project["project"]["id"]
```

**Get type IDs:**

```python
types = mcp_openproject_list_types(project_id=openproject_project_id)
# Extract: epic, feature, user_story, task, bug, milestone IDs
```

**Get status IDs:**

```python
statuses = mcp_openproject_list_statuses()
# Extract: new, in_progress, in_testing, closed, on_hold IDs
```

**Get priority IDs:**

```python
priorities = mcp_openproject_list_priorities()
# Extract: low, normal, high, immediate IDs
```

### Step 3: Configure Archon

**Execute:**

```python
# Check for existing Archon project
projects = mcp_archon_find_projects(query="{project_name}")
```

**If no existing project:**

```python
archon_project = mcp_archon_manage_project(
    action="create",
    title="{display_name} - Knowledge Base",
    description="Technical documentation and research for {display_name}",
    github_repo="{github_url}"
)
archon_project_id = archon_project["project"]["id"]
```

**Get available knowledge sources:**

```python
sources = mcp_archon_rag_get_available_sources()
# Display for user reference
```

### Step 4: Update Configuration File

**Generate `_bmad/_config/project-config.yaml`:**

```yaml
# Generated by BMAD Project Init
# Date: {current_date}

project:
  name: "{project_name}"
  display_name: "{display_name}"
  description: "{description}"
  github_repo: "{github_url}"

team:
  user_name: "{user_name}"
  user_skill_level: "intermediate"
  communication_language: "English"
  document_output_language: "English"

paths:
  output_folder: "{project-root}/_bmad-output"
  planning_artifacts: "{project-root}/_bmad-output/planning-artifacts"
  implementation_artifacts: "{project-root}/_bmad-output/implementation-artifacts"
  project_knowledge: "{project-root}/docs"

openproject:
  enabled: true
  project_id: { openproject_project_id }
  types:
    epic: { epic_type_id }
    feature: { feature_type_id }
    user_story: { user_story_type_id }
    task: { task_type_id }
    bug: { bug_type_id }
    milestone: { milestone_type_id }
  statuses:
    new: { new_status_id }
    in_specification: { in_spec_status_id }
    specified: { specified_status_id }
    confirmed: { confirmed_status_id }
    to_be_scheduled: { to_be_scheduled_id }
    scheduled: { scheduled_status_id }
    in_progress: { in_progress_status_id }
    developed: { developed_status_id }
    in_testing: { in_testing_status_id }
    tested: { tested_status_id }
    test_failed: { test_failed_status_id }
    closed: { closed_status_id }
    on_hold: { on_hold_status_id }
    rejected: { rejected_status_id }
  priorities:
    low: { low_priority_id }
    normal: { normal_priority_id }
    high: { high_priority_id }
    immediate: { immediate_priority_id }
  workflow:
    default_status: { new_status_id }
    start_work_status: { in_progress_status_id }
    review_status: { in_testing_status_id }
    complete_status: { closed_status_id }

archon:
  enabled: true
  project_id: "{archon_project_id}"
  rag:
    default_match_count: 5
    code_examples_match_count: 3
    preferred_sources: []

testing:
  tea_use_mcp_enhancements: false
  tea_use_playwright_utils: false

workflows:
  story_min_hours: 0.5
  story_max_hours: 4
  sprint_duration_days: 14
  require_acceptance_criteria: true
  require_technical_notes: true

custom: {}
```

### Step 5: Generate CLAUDE.md

**Read template:**

```
_bmad/templates/CLAUDE.md.template
```

**Replace placeholders:**

- `{{PROJECT_NAME}}` → `{display_name}`
- `{{OPENPROJECT_PROJECT_ID}}` → `{openproject_project_id}`
- `{{ARCHON_PROJECT_ID}}` → `{archon_project_id}`
- `{{TYPE_EPIC}}` → `{epic_type_id}`
- `{{TYPE_FEATURE}}` → `{feature_type_id}`
- `{{TYPE_USER_STORY}}` → `{user_story_type_id}`
- `{{TYPE_TASK}}` → `{task_type_id}`
- `{{TYPE_BUG}}` → `{bug_type_id}`
- `{{STATUS_NEW}}` → `{new_status_id}`
- `{{STATUS_IN_PROGRESS}}` → `{in_progress_status_id}`
- `{{STATUS_IN_TESTING}}` → `{in_testing_status_id}`
- `{{STATUS_CLOSED}}` → `{closed_status_id}`
- `{{STATUS_ON_HOLD}}` → `{on_hold_status_id}`
- `{{PRIORITY_LOW}}` → `{low_priority_id}`
- `{{PRIORITY_NORMAL}}` → `{normal_priority_id}`
- `{{PRIORITY_HIGH}}` → `{high_priority_id}`
- `{{PRIORITY_IMMEDIATE}}` → `{immediate_priority_id}`
- `{{STORY_MIN_HOURS}}` → `0.5`
- `{{STORY_MAX_HOURS}}` → `4`

**Write to:**

```
{project-root}/CLAUDE.md
```

### Step 6: Create Output Directories

```bash
mkdir -p _bmad-output/planning-artifacts
mkdir -p _bmad-output/implementation-artifacts
```

### Step 7: Validate Configuration

**Test OpenProject connection:**

```python
test = mcp_openproject_test_connection()
assert test is successful

# Verify project access
project = mcp_openproject_get_project(project_id=openproject_project_id)
assert project exists
```

**Test Archon connection:**

```python
health = mcp_archon_health_check()
assert health is healthy

# Verify project access
project = mcp_archon_find_projects(project_id=archon_project_id)
assert project exists
```

### Step 8: Display Summary

```
╔══════════════════════════════════════════════════════════════╗
║              BMAD Project Initialization Complete             ║
╠══════════════════════════════════════════════════════════════╣
║                                                               ║
║  Project: {display_name}                                      ║
║                                                               ║
║  OpenProject:                                                 ║
║    Project ID: {openproject_project_id}                       ║
║    Status: ✅ Connected                                       ║
║                                                               ║
║  Archon:                                                      ║
║    Project ID: {archon_project_id}                            ║
║    Status: ✅ Connected                                       ║
║                                                               ║
║  Files Created:                                               ║
║    ✅ _bmad/_config/project-config.yaml                       ║
║    ✅ CLAUDE.md                                               ║
║    ✅ _bmad-output/planning-artifacts/                        ║
║    ✅ _bmad-output/implementation-artifacts/                  ║
║                                                               ║
║  Next Steps:                                                  ║
║    1. Review project-config.yaml for accuracy                 ║
║    2. Run @bmad/bmm/agents/pm to create product brief         ║
║    3. Follow BMAD workflow for development                    ║
║                                                               ║
╚══════════════════════════════════════════════════════════════╝
```

## Error Handling

### OpenProject Connection Failed

```
⚠️ Could not connect to OpenProject MCP server.

Troubleshooting:
1. Verify OpenProject MCP is running
2. Check MCP configuration in Cursor settings
3. Verify network connectivity

You can skip OpenProject setup and configure manually later in project-config.yaml
```

### Archon Connection Failed

```
⚠️ Could not connect to Archon MCP server.

Troubleshooting:
1. Verify Archon MCP is running
2. Check MCP configuration in Cursor settings
3. Verify network connectivity

You can skip Archon setup and configure manually later in project-config.yaml
```

## Manual Configuration

If automated setup fails, manually edit `_bmad/_config/project-config.yaml`:

1. Get OpenProject project ID from OpenProject UI
2. Get type/status/priority IDs using MCP tools or API
3. Create Archon project and get UUID
4. Update config file
5. Run `python scripts/bmad-setup.py generate-claude-md` to regenerate CLAUDE.md










